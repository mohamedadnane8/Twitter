{% extends "network/layout.html" %}
{% load static %}
{% block beg_script %}
    <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

{% endblock %}
{% block body %}
 <div class="page-header header-filter" data-parallax="true" id = "background-image" >
    <div class="main main-raised">
		<div class="profile-content">
            <div class="container">
                <div class="row">
                  <div id="user_info" style="margin: auto">
                    <div class="col-md-6 ml-auto mr-auto">
          	           <div class="profile text-center">
  	                        <div class="avatar">
                              <br>

  	                            <img src="" alt="Circle Image" id = "profile_img" class="img-raised rounded-circle img-fluid">
  	                        </div>
  	                        <div class="name">
  	                            <h3 class="title" id = "name"></h3>
  	                        </div>
                            <div class="row mt-1">
                                 <div class="col border-left border-right text-center">
                                     <h5 class="text-uppercase">Followers</h5>
                                     <h4 class="font-light" id = "followers_count"></h4>

                                 </div>
                                 <div class="col border-right text-center">
                                     <h5 class="text-uppercase">Following</h5>
                                      <h4 class="font-light" id = "followings_count"></h4>
                                 </div>

                             </div>
                           {% if user_info.id == user.id %}
                               {% else %}
                           <div id="app"></div>
                           {% endif %}

  	                    </div>
      	            </div>
                      <br><br>
                    <div class="description text-center">
                        <p>{{user_info.about}}</p>
                    </div>
                  </div>

                </div>

                <div id="tweets">

                </div>
            </div>




            </div>
        </div>
	</div>
    </div>
{% endblock %}
{% block script %}

<script>
  var received_data  = {{user_info|safe}};
  var user_posts = {{user_post|safe}};
  var is_followed = "{{is_followed|safe}}" === "True";
</script>
    <script type="text/babel">

            class Follow extends React.Component {
                constructor(props) {
                    super(props)
                    this.state = {
                        status: {is_followed},
                        color: {is_followed} ? "red" : "blue",
                        text_follow: {is_followed} ? "follow" : "unfollow",

                    };
                }

                render() {

                    return this.renderFollowBtn();

                }

                renderFollowBtn() {
                    return <button onClick={this.follo} type="button" id = "follow" className="follow btn btn-primary" data-follow = "follow"> {this.state.status ? "follow" : "unfollow"}</button>;
                }


                  follo = () => {
                    alert("${this.state.status}")
                    fetch('/follow/', {
                            method: 'POST',
                            body: JSON.stringify({
                                user: received_data.id,
                                follow_status: this.state.status
                            })
                        })
                        .then(response => response.json())
                        .then(result => {
                            // Print result
                            this.setState(state => ({
                                status : !(state.status),
                                text_follow: {is_followed} ? "follow" : "unfollow",
                            }));
                            this.renderFollowBtn();
                            console.log(result);
                        });
                }
            }

            ReactDOM.render(<Follow />, document.querySelector("#app"));
        </script>
<script src="{% static 'network/js/profile.js' %}"></script>

{% endblock %}
